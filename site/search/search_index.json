{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\ud83c\udfe1 Bienvenido a Server Labs \u00b6 Esta documentaci\u00f3n te guiar\u00e1 paso a paso en la creaci\u00f3n de tu infraestructura con XCP-ng , Linux y Contenedores Docker . Sigue la gu\u00eda seg\u00fan tu objetivo: despliegue de VM, contenedores o referencia de comandos \u00fatiles. \u2699\ufe0f 1. Preparaci\u00f3n de la Infraestructura \u00b6 Servidor XCP-ng: Instalaci\u00f3n de XCP-ng Despliegue VM Alpine Linux: Gu\u00eda paso a paso \ud83d\udd12 2. Despliegue en producci\u00f3n de sitio web \u00b6 Instalaci\u00f3n y configuraci\u00f3n de Nginx y Hugo Despliegue completo Configuraci\u00f3n del stack Alpine-Nginx-MariaDB-WordPress Despliegue completo Cloudflare Tunnel: Configuraci\u00f3n segura \ud83d\udee1\ufe0f 3. Contenedores docker en acci\u00f3n \u00b6 \ud83d\udcda Ap\u00e9ndices \u00b6 Comandos \u00datiles: Referencia r\u00e1pida Gu\u00eda de Estilo (Oficial): Normas de documentaci\u00f3n \ud83d\udd17 Recursos Adicionales \u00b6 Repositorio GitHub del proyecto Abrir un Issue o Pull Request \ud83d\udca1 Tip: Usa la barra de b\u00fasqueda de la p\u00e1gina para encontrar cualquier comando, archivo o secci\u00f3n.","title":"\ud83c\udfe1 Inicio"},{"location":"#bienvenido-a-server-labs","text":"Esta documentaci\u00f3n te guiar\u00e1 paso a paso en la creaci\u00f3n de tu infraestructura con XCP-ng , Linux y Contenedores Docker . Sigue la gu\u00eda seg\u00fan tu objetivo: despliegue de VM, contenedores o referencia de comandos \u00fatiles.","title":"\ud83c\udfe1 Bienvenido a Server Labs"},{"location":"#1-preparacion-de-la-infraestructura","text":"Servidor XCP-ng: Instalaci\u00f3n de XCP-ng Despliegue VM Alpine Linux: Gu\u00eda paso a paso","title":"\u2699\ufe0f 1. Preparaci\u00f3n de la Infraestructura"},{"location":"#2-despliegue-en-produccion-de-sitio-web","text":"Instalaci\u00f3n y configuraci\u00f3n de Nginx y Hugo Despliegue completo Configuraci\u00f3n del stack Alpine-Nginx-MariaDB-WordPress Despliegue completo Cloudflare Tunnel: Configuraci\u00f3n segura","title":"\ud83d\udd12 2. Despliegue en producci\u00f3n de sitio web"},{"location":"#3-contenedores-docker-en-accion","text":"","title":"\ud83d\udee1\ufe0f 3. Contenedores docker en acci\u00f3n"},{"location":"#apendices","text":"Comandos \u00datiles: Referencia r\u00e1pida Gu\u00eda de Estilo (Oficial): Normas de documentaci\u00f3n","title":"\ud83d\udcda Ap\u00e9ndices"},{"location":"#recursos-adicionales","text":"Repositorio GitHub del proyecto Abrir un Issue o Pull Request \ud83d\udca1 Tip: Usa la barra de b\u00fasqueda de la p\u00e1gina para encontrar cualquier comando, archivo o secci\u00f3n.","title":"\ud83d\udd17 Recursos Adicionales"},{"location":"apendices/comandos_utiles/","text":"\ud83d\udee0\ufe0f Comandos \u00datiles y de Referencia Este ap\u00e9ndice contiene una lista de comandos esenciales para la gesti\u00f3n diaria y la soluci\u00f3n de problemas (troubleshooting) de los componentes clave de la infraestructura. \u2699\ufe0f Gesti\u00f3n de la M\u00e1quina Virtual (XCP-ng Console) Estos comandos se ejecutan en la consola de root del servidor XCP-ng. Verificar el estado del host: xe host-list Verificar el estado de las VMs: xe vm-list Encender una VM (usando el nombre): xe vm-start vm=[Nombre de la VM] Apagar una VM (apagado limpio): xe vm-shutdown vm=[Nombre de la VM] Verificar el estado de los Storage Repositories (SR): xe sr-list 1.2. Ejemplo de redimensionamiento de una VM Alpine Linux de 20 GiB a 40 GiB Ejecutar en el host Xen xe vm-shutdown vm=VM xe vm-disk-list vm=VM xe vdi-resize uuid=VDI_UUID disk-size=40GiB xe vm-start vm=VM Ejecutar en la VM Alpine apk add util-linux e2fsprogs growpart /dev/xvda 3 resize2fs /dev/xvda3 df -h \ud83d\udc33 Gesti\u00f3n de Contenedores (Podman) Estos comandos se ejecutan dentro de la VM Debian como tu usuario est\u00e1ndar (admin), en modo rootless. Verificar todos los contenedores (activos e inactivos): podman ps -a Verificar todas las im\u00e1genes descargadas: podman images Verificar las redes de Podman: podman network ls Detener el stack completo (en el directorio del podman-compose.yml): podman-compose down Reiniciar el stack: podman-compose restart Ver logs de un contenedor (ej: WordPress): podman logs -f wordpress_app Ejecutar un comando dentro de un contenedor (ej: en NGINX): podman exec -it nginx_proxy /bin/ Limpiar contenedores y vol\u00famenes no utilizados (\u00a1Usar con precauci\u00f3n!): podman system prune \ud83d\udee1\ufe0f Cloudflared Estos comandos se ejecutan en la VM Debian para verificar el estado de los servicios. A. Cloudflare Tunnel Verificar el estado del servicio cloudflared: sudo systemctl status cloudflared Ver logs del servicio cloudflared: sudo journalctl -u cloudflared -f \ud83d\udee0\ufe0f","title":"Comandos \u00datiles"},{"location":"preparacion/instalacion_alpine/","text":"1.2. Despliegue VM Alpine Linux \u00b6 Este apartado describe el proceso completo para desplegar una m\u00e1quina virtual con Alpine Linux sobre un servidor XCP-ng, as\u00ed como su configuraci\u00f3n inicial para dejarla lista para administraci\u00f3n remota y uso de contenedores con Docker. 1.2.1. Requisitos previos \u00b6 Antes de comenzar, aseg\u00farate de contar con: Servidor XCP-ng correctamente instalado y operativo Acceso a Xen Orchestra (XO Lite o completo) Imagen ISO de Alpine Linux (Standard x86_64) Conectividad de red funcional Conocimientos b\u00e1sicos de consola Linux 1.2.2. Creaci\u00f3n de la m\u00e1quina virtual en XCP-ng \u00b6 Accede a Xen Orchestra Selecciona New VM Elige la plantilla: Other install media Asigna los recursos recomendados: CPU: 1\u20132 vCPU RAM: 512 MB (m\u00ednimo) / 1 GB recomendado Disco: 8\u201316 GB Adjunta la ISO de Alpine Linux Configura la interfaz de red (bridge por defecto) Finaliza y arranca la VM 1.2.3. Instalaci\u00f3n base de Alpine Linux \u00b6 En la consola de la VM, inicia sesi\u00f3n como: login: root Ejecuta el instalador: setup-alpine Responde a las preguntas principales: Teclado: es o us Hostname: (ej. alpine-vm) Red: DHCP (recomendado) Zona horaria: Europe/Madrid (o la correspondiente) Repositorio: por defecto Disco: sys Modo: standard Confirma la instalaci\u00f3n y espera a que finalice. Reinicia el sistema: reboot 1.2.4. Configuraci\u00f3n del acceso por SSH \u00b6 Instala el servidor OpenSSH: apk add openssh Habilita el servicio: rc-update add sshd rc-service sshd start Verifica que el servicio est\u00e9 activo: rc-service sshd status (Opcional pero recomendado) Edita la configuraci\u00f3n: vi /etc/ssh/sshd_config Aseg\u00farate de: PermitRootLogin no PasswordAuthentication yes Reinicia SSH: rc-service sshd restart 1.2.5. Creaci\u00f3n de un nuevo usuario \u00b6 Crea un usuario (ejemplo: admin): adduser admin A\u00f1\u00e1delo a los grupos necesarios: addgroup admin wheel Verifica: id admin 1.2.6. Configuraci\u00f3n de doas (sudo en Alpine) \u00b6 Alpine utiliza doas en lugar de sudo. Instala doas: apk add doas Edita el archivo de configuraci\u00f3n: vi /etc/doas.conf A\u00f1ade la siguiente l\u00ednea: permit persist :wheel Asegura permisos correctos: chmod 0400 /etc/doas.conf Cambia al nuevo usuario y prueba: su - admin doas apk update 1.2.7. Instalaci\u00f3n de herramientas b\u00e1sicas \u00b6 Instala utilidades comunes para administraci\u00f3n: doas apk add \\ curl \\ wget \\ vim \\ btop \\ bash \\ git \\ ca-certificates Establece Bash como shell por defecto (opcional): doas chsh -s /bin/bash admin 1.2.8. Instalaci\u00f3n y configuraci\u00f3n de Docker \u00b6 Instala Docker: doas apk add docker Habilita el servicio: doas rc-update add docker doas rc-service docker start A\u00f1ade el usuario al grupo docker: doas addgroup admin docker Cierra sesi\u00f3n y vuelve a entrar para aplicar cambios. Verifica la instalaci\u00f3n: docker version docker run hello-world 1.2.9. Configuraci\u00f3n final recomendada \u00b6 Actualiza el sistema: doas apk update && doas apk upgrade Configura IP est\u00e1tica (opcional): vi /etc/network/interfaces","title":"1.2. Despliegue VM Alpine LInux"},{"location":"preparacion/instalacion_alpine/#12-despliegue-vm-alpine-linux","text":"Este apartado describe el proceso completo para desplegar una m\u00e1quina virtual con Alpine Linux sobre un servidor XCP-ng, as\u00ed como su configuraci\u00f3n inicial para dejarla lista para administraci\u00f3n remota y uso de contenedores con Docker.","title":"1.2. Despliegue VM Alpine Linux"},{"location":"preparacion/instalacion_alpine/#121-requisitos-previos","text":"Antes de comenzar, aseg\u00farate de contar con: Servidor XCP-ng correctamente instalado y operativo Acceso a Xen Orchestra (XO Lite o completo) Imagen ISO de Alpine Linux (Standard x86_64) Conectividad de red funcional Conocimientos b\u00e1sicos de consola Linux","title":"1.2.1. Requisitos previos"},{"location":"preparacion/instalacion_alpine/#122-creacion-de-la-maquina-virtual-en-xcp-ng","text":"Accede a Xen Orchestra Selecciona New VM Elige la plantilla: Other install media Asigna los recursos recomendados: CPU: 1\u20132 vCPU RAM: 512 MB (m\u00ednimo) / 1 GB recomendado Disco: 8\u201316 GB Adjunta la ISO de Alpine Linux Configura la interfaz de red (bridge por defecto) Finaliza y arranca la VM","title":"1.2.2. Creaci\u00f3n de la m\u00e1quina virtual en XCP-ng"},{"location":"preparacion/instalacion_alpine/#123-instalacion-base-de-alpine-linux","text":"En la consola de la VM, inicia sesi\u00f3n como: login: root Ejecuta el instalador: setup-alpine Responde a las preguntas principales: Teclado: es o us Hostname: (ej. alpine-vm) Red: DHCP (recomendado) Zona horaria: Europe/Madrid (o la correspondiente) Repositorio: por defecto Disco: sys Modo: standard Confirma la instalaci\u00f3n y espera a que finalice. Reinicia el sistema: reboot","title":"1.2.3. Instalaci\u00f3n base de Alpine Linux"},{"location":"preparacion/instalacion_alpine/#124-configuracion-del-acceso-por-ssh","text":"Instala el servidor OpenSSH: apk add openssh Habilita el servicio: rc-update add sshd rc-service sshd start Verifica que el servicio est\u00e9 activo: rc-service sshd status (Opcional pero recomendado) Edita la configuraci\u00f3n: vi /etc/ssh/sshd_config Aseg\u00farate de: PermitRootLogin no PasswordAuthentication yes Reinicia SSH: rc-service sshd restart","title":"1.2.4. Configuraci\u00f3n del acceso por SSH"},{"location":"preparacion/instalacion_alpine/#125-creacion-de-un-nuevo-usuario","text":"Crea un usuario (ejemplo: admin): adduser admin A\u00f1\u00e1delo a los grupos necesarios: addgroup admin wheel Verifica: id admin","title":"1.2.5. Creaci\u00f3n de un nuevo usuario"},{"location":"preparacion/instalacion_alpine/#126-configuracion-de-doas-sudo-en-alpine","text":"Alpine utiliza doas en lugar de sudo. Instala doas: apk add doas Edita el archivo de configuraci\u00f3n: vi /etc/doas.conf A\u00f1ade la siguiente l\u00ednea: permit persist :wheel Asegura permisos correctos: chmod 0400 /etc/doas.conf Cambia al nuevo usuario y prueba: su - admin doas apk update","title":"1.2.6. Configuraci\u00f3n de doas (sudo en Alpine)"},{"location":"preparacion/instalacion_alpine/#127-instalacion-de-herramientas-basicas","text":"Instala utilidades comunes para administraci\u00f3n: doas apk add \\ curl \\ wget \\ vim \\ btop \\ bash \\ git \\ ca-certificates Establece Bash como shell por defecto (opcional): doas chsh -s /bin/bash admin","title":"1.2.7. Instalaci\u00f3n de herramientas b\u00e1sicas"},{"location":"preparacion/instalacion_alpine/#128-instalacion-y-configuracion-de-docker","text":"Instala Docker: doas apk add docker Habilita el servicio: doas rc-update add docker doas rc-service docker start A\u00f1ade el usuario al grupo docker: doas addgroup admin docker Cierra sesi\u00f3n y vuelve a entrar para aplicar cambios. Verifica la instalaci\u00f3n: docker version docker run hello-world","title":"1.2.8. Instalaci\u00f3n y configuraci\u00f3n de Docker"},{"location":"preparacion/instalacion_alpine/#129-configuracion-final-recomendada","text":"Actualiza el sistema: doas apk update && doas apk upgrade Configura IP est\u00e1tica (opcional): vi /etc/network/interfaces","title":"1.2.9. Configuraci\u00f3n final recomendada"},{"location":"preparacion/instalacion_xo_lite/","text":"\u2699\ufe0f Instalaci\u00f3n y Configuraci\u00f3n del Servidor XCP-ng \u00b6 Esta gu\u00eda detalla el proceso para establecer la plataforma de virtualizaci\u00f3n utilizando XCP-ng , la interfaz web ligera y moderna para gestionar el hypervisor XCP-ng (o XenServer). Nota: XCP-ng no es el hypervisor , sino la interfaz de gesti\u00f3n. Primero se instala XCP-ng y luego se accede a su interfaz web integrada. \ud83d\udccb 1.1. Prerrequisitos \u00b6 Antes de comenzar, aseg\u00farate de contar con: Un servidor f\u00edsico o m\u00e1quina virtual para instalar el hypervisor XCP-ng. Medios de instalaci\u00f3n de XCP-ng (USB o ISO). Acceso a la red local. Importante Guarda cuidadosamente la contrase\u00f1a de root que establecer\u00e1s durante la instalaci\u00f3n. Ser\u00e1 esencial para la gesti\u00f3n del servidor. \ud83d\udda5\ufe0f 1.1.1 Instalaci\u00f3n del Hypervisor XCP-ng \u00b6 La instalaci\u00f3n del hypervisor es el paso fundamental para acceder a XCP-ng. 1.1.2 Arranque desde el medio de instalaci\u00f3n \u00b6 Inicia el servidor usando la imagen ISO o USB de XCP-ng. El asistente te guiar\u00e1 paso a paso: Selecciona el idioma y la distribuci\u00f3n del teclado. Acepta el acuerdo de licencia (EULA) . Selecciona el disco donde se instalar\u00e1 el sistema operativo del hypervisor. Configura la contrase\u00f1a de root . Configura la red (se recomienda IP est\u00e1tica para servidores). Configura la zona horaria . Finalizaci\u00f3n: el sistema instalar\u00e1 los archivos y te pedir\u00e1 retirar el medio y reiniciar. \ud83c\udf10 1.1.3. Acceso Inicial a la Interfaz XCP-ng \u00b6 Tras reiniciar el servidor: 1.1.4. Obtener la Direcci\u00f3n IP \u00b6 La consola de XCP-ng mostrar\u00e1 la IP asignada (ejemplo: 192.168.1.10 ). 1.1.5. Acceder desde el navegador \u00b6 Abre un navegador web y navega a: https://192.168.1.10 Certificado autofirmado Es probable que tu navegador muestre una advertencia de seguridad. Acepta el certificado para continuar. 1.1.6. Inicio de sesi\u00f3n en XCP-ng \u00b6 Usuario: root Contrase\u00f1a: La que configuraste durante la instalaci\u00f3n de XCP-ng \u2699\ufe0f 1.1.7. Configuraci\u00f3n Post-Instalaci\u00f3n en XCP-ng \u00b6 Dentro de XCP-ng, realiza estas configuraciones b\u00e1sicas: 1.1.8. Configuraci\u00f3n de Red \u00b6 Verifica que la interfaz de red (NIC) tenga la IP, m\u00e1scara y gateway correctos. Configura redes virtuales o VLANs si es necesario. 1.1.9. Configuraci\u00f3n de Almacenamiento (Storage) \u00b6 Crea un SR (Storage Repository) para alojar las m\u00e1quinas virtuales. Ejemplos de opciones comunes: LVM Local (disco f\u00edsico dedicado) NFS o SMB (almacenamiento en red) Tip Si instalaste en un disco peque\u00f1o y tienes un disco m\u00e1s grande para VMs, crea un SR separado en ese disco para optimizar el rendimiento. 1.1.10. Actualizaciones \u00b6 XCP-ng facilita la aplicaci\u00f3n de parches y actualizaciones del hypervisor. Aseg\u00farate de que XCP-ng est\u00e9 actualizado antes de desplegar tus VMs. \u2705 Con la instalaci\u00f3n y configuraci\u00f3n b\u00e1sica de XCP-ng completada, tu hypervisor XCP-ng est\u00e1 listo para administrar m\u00e1quinas virtuales de forma eficiente y segura. \u27a1\ufe0f Siguiente paso recomendado: Contin\u00faa con la preparaci\u00f3n del entorno para contenedores: Preparaci\u00f3n de Podman","title":"1.1. Servidor XCP-ng"},{"location":"preparacion/instalacion_xo_lite/#instalacion-y-configuracion-del-servidor-xcp-ng","text":"Esta gu\u00eda detalla el proceso para establecer la plataforma de virtualizaci\u00f3n utilizando XCP-ng , la interfaz web ligera y moderna para gestionar el hypervisor XCP-ng (o XenServer). Nota: XCP-ng no es el hypervisor , sino la interfaz de gesti\u00f3n. Primero se instala XCP-ng y luego se accede a su interfaz web integrada.","title":"\u2699\ufe0f Instalaci\u00f3n y Configuraci\u00f3n del Servidor XCP-ng"},{"location":"preparacion/instalacion_xo_lite/#11-prerrequisitos","text":"Antes de comenzar, aseg\u00farate de contar con: Un servidor f\u00edsico o m\u00e1quina virtual para instalar el hypervisor XCP-ng. Medios de instalaci\u00f3n de XCP-ng (USB o ISO). Acceso a la red local. Importante Guarda cuidadosamente la contrase\u00f1a de root que establecer\u00e1s durante la instalaci\u00f3n. Ser\u00e1 esencial para la gesti\u00f3n del servidor.","title":"\ud83d\udccb 1.1. Prerrequisitos"},{"location":"preparacion/instalacion_xo_lite/#111-instalacion-del-hypervisor-xcp-ng","text":"La instalaci\u00f3n del hypervisor es el paso fundamental para acceder a XCP-ng.","title":"\ud83d\udda5\ufe0f 1.1.1 Instalaci\u00f3n del Hypervisor XCP-ng"},{"location":"preparacion/instalacion_xo_lite/#112-arranque-desde-el-medio-de-instalacion","text":"Inicia el servidor usando la imagen ISO o USB de XCP-ng. El asistente te guiar\u00e1 paso a paso: Selecciona el idioma y la distribuci\u00f3n del teclado. Acepta el acuerdo de licencia (EULA) . Selecciona el disco donde se instalar\u00e1 el sistema operativo del hypervisor. Configura la contrase\u00f1a de root . Configura la red (se recomienda IP est\u00e1tica para servidores). Configura la zona horaria . Finalizaci\u00f3n: el sistema instalar\u00e1 los archivos y te pedir\u00e1 retirar el medio y reiniciar.","title":"1.1.2 Arranque desde el medio de instalaci\u00f3n"},{"location":"preparacion/instalacion_xo_lite/#113-acceso-inicial-a-la-interfaz-xcp-ng","text":"Tras reiniciar el servidor:","title":"\ud83c\udf10 1.1.3. Acceso Inicial a la Interfaz XCP-ng"},{"location":"preparacion/instalacion_xo_lite/#114-obtener-la-direccion-ip","text":"La consola de XCP-ng mostrar\u00e1 la IP asignada (ejemplo: 192.168.1.10 ).","title":"1.1.4. Obtener la Direcci\u00f3n IP"},{"location":"preparacion/instalacion_xo_lite/#115-acceder-desde-el-navegador","text":"Abre un navegador web y navega a: https://192.168.1.10 Certificado autofirmado Es probable que tu navegador muestre una advertencia de seguridad. Acepta el certificado para continuar.","title":"1.1.5. Acceder desde el navegador"},{"location":"preparacion/instalacion_xo_lite/#116-inicio-de-sesion-en-xcp-ng","text":"Usuario: root Contrase\u00f1a: La que configuraste durante la instalaci\u00f3n de XCP-ng","title":"1.1.6. Inicio de sesi\u00f3n en XCP-ng"},{"location":"preparacion/instalacion_xo_lite/#117-configuracion-post-instalacion-en-xcp-ng","text":"Dentro de XCP-ng, realiza estas configuraciones b\u00e1sicas:","title":"\u2699\ufe0f 1.1.7. Configuraci\u00f3n Post-Instalaci\u00f3n en XCP-ng"},{"location":"preparacion/instalacion_xo_lite/#118-configuracion-de-red","text":"Verifica que la interfaz de red (NIC) tenga la IP, m\u00e1scara y gateway correctos. Configura redes virtuales o VLANs si es necesario.","title":"1.1.8. Configuraci\u00f3n de Red"},{"location":"preparacion/instalacion_xo_lite/#119-configuracion-de-almacenamiento-storage","text":"Crea un SR (Storage Repository) para alojar las m\u00e1quinas virtuales. Ejemplos de opciones comunes: LVM Local (disco f\u00edsico dedicado) NFS o SMB (almacenamiento en red) Tip Si instalaste en un disco peque\u00f1o y tienes un disco m\u00e1s grande para VMs, crea un SR separado en ese disco para optimizar el rendimiento.","title":"1.1.9. Configuraci\u00f3n de Almacenamiento (Storage)"},{"location":"preparacion/instalacion_xo_lite/#1110-actualizaciones","text":"XCP-ng facilita la aplicaci\u00f3n de parches y actualizaciones del hypervisor. Aseg\u00farate de que XCP-ng est\u00e9 actualizado antes de desplegar tus VMs. \u2705 Con la instalaci\u00f3n y configuraci\u00f3n b\u00e1sica de XCP-ng completada, tu hypervisor XCP-ng est\u00e1 listo para administrar m\u00e1quinas virtuales de forma eficiente y segura. \u27a1\ufe0f Siguiente paso recomendado: Contin\u00faa con la preparaci\u00f3n del entorno para contenedores: Preparaci\u00f3n de Podman","title":"1.1.10. Actualizaciones"},{"location":"seguridad/cloudflare_tunnel/","text":"5. Conexi\u00f3n Segura con Cloudflare Tunnel \u00b6 Cloudflare Tunnel (anteriormente conocido como Argo Tunnel) crea una conexi\u00f3n saliente segura entre tu VM (servidor local) y la red de Cloudflare. Esto permite que el tr\u00e1fico web llegue a tus contenedores sin exponer directamente tu IP p\u00fablica o requerir configuraciones complejas de firewall o redirecci\u00f3n de puertos (port forwarding). 5.1. Prerrequisitos en Cloudflare Dominio Activo: Tu dominio debe estar utilizando los servidores de nombres de Cloudflare. Registro DNS: Aseg\u00farate de tener un registro A o CNAME en Cloudflare para el subdominio que usar\u00e1s (ej: web.tudominio.com). El valor de la IP puede ser ficticio, ya que el Tunnel lo anular\u00e1. 5.2. Instalaci\u00f3n del Cliente cloudflared Instalaremos el cliente que gestionar\u00e1 el t\u00fanel en tu VM Debian Trixie. Descargar el Repositorio de Cloudflare: curl -fsSL https://pkg.cloudflare.com/pubkey.gpg | sudo gpg --dearmor -o /usr/share/keyrings/cloudflare.gpg echo 'deb [signed-by=/usr/share/keyrings/cloudflare.gpg] https://pkg.cloudflare.com/cloudflared trixie main' | sudo tee /etc/apt/sources.list.d/cloudflared.list Actualizar e Instalar: sudo apt update sudo apt install -y cloudflared 5.3. Creaci\u00f3n y Configuraci\u00f3n del Tunnel La configuraci\u00f3n se realiza en dos partes: autenticaci\u00f3n y definici\u00f3n del t\u00fanel (rutas). A. Autenticaci\u00f3n Autentica tu cloudflared con tu cuenta de Cloudflare. Se te pedir\u00e1 iniciar sesi\u00f3n en el navegador. cloudflared tunnel login Se abrir\u00e1 una URL en tu terminal. P\u00e9gala en tu navegador, inicia sesi\u00f3n en Cloudflare y selecciona tu dominio. B. Crear el T\u00fanel Asigna un nombre a tu t\u00fanel y crea la configuraci\u00f3n local. Crear el T\u00fanel: cloudflared tunnel create wp-tunnel (Esto te dar\u00e1 un ID de t\u00fanel \u00fanico que necesitar\u00e1s) \u00b6 Crear el Archivo de Configuraci\u00f3n (config.yml): Crea el directorio de configuraci\u00f3n para cloudflared y el archivo config.yml. sudo mkdir /etc/cloudflared sudo nano /etc/cloudflared/config.yml Pega la siguiente configuraci\u00f3n, asegur\u00e1ndote de reemplazar con el ID \u00fanico que obtuviste en el paso anterior: tunnel: <TUNNEL-ID> credentials-file: /root/.cloudflared/<TUNNEL-ID>.json ingress: # Regla 1: Tr\u00e1fico del dominio al puerto 80 del servidor local. - hostname: web.tudominio.com # Reemplaza con tu dominio service: http://localhost:80 # Regla final: Bloquea cualquier otra petici\u00f3n no mapeada. - service: http_status:404 Aqu\u00ed, http://localhost:80 se refiere al puerto del host donde est\u00e1 escuchando tu contenedor NGINX. C. Mapeo DNS y T\u00fanel Conecta el t\u00fanel a tu dominio en el panel de Cloudflare. cloudflared tunnel route dns wp-tunnel web.tudominio.com Esto crea autom\u00e1ticamente el registro DNS de tipo CNAME en tu zona de Cloudflare, apuntando a tu t\u00fanel. 5.4. Ejecuci\u00f3n del Tunnel como Servicio Ejecuta el cliente cloudflared como un servicio persistente. Instalar el Servicio del Sistema (Systemd): sudo cloudflared tunnel run --overwrite-service Iniciar y Habilitar el Servicio: sudo systemctl start cloudflared sudo systemctl enable cloudflared Verificar el Estado: sudo systemctl status cloudflared El estado debe mostrarse como active (running). Una vez que el servicio est\u00e9 activo, tu sitio web de WordPress ser\u00e1 accesible a trav\u00e9s de web.tudominio.com sin que hayas abierto un solo puerto en tu router o firewall local. Todo el tr\u00e1fico pasa a trav\u00e9s de la infraestructura segura de Cloudflare.","title":"2.3. Cloudflare Tunnel"},{"location":"seguridad/cloudflare_tunnel/#5-conexion-segura-con-cloudflare-tunnel","text":"Cloudflare Tunnel (anteriormente conocido como Argo Tunnel) crea una conexi\u00f3n saliente segura entre tu VM (servidor local) y la red de Cloudflare. Esto permite que el tr\u00e1fico web llegue a tus contenedores sin exponer directamente tu IP p\u00fablica o requerir configuraciones complejas de firewall o redirecci\u00f3n de puertos (port forwarding). 5.1. Prerrequisitos en Cloudflare Dominio Activo: Tu dominio debe estar utilizando los servidores de nombres de Cloudflare. Registro DNS: Aseg\u00farate de tener un registro A o CNAME en Cloudflare para el subdominio que usar\u00e1s (ej: web.tudominio.com). El valor de la IP puede ser ficticio, ya que el Tunnel lo anular\u00e1. 5.2. Instalaci\u00f3n del Cliente cloudflared Instalaremos el cliente que gestionar\u00e1 el t\u00fanel en tu VM Debian Trixie. Descargar el Repositorio de Cloudflare: curl -fsSL https://pkg.cloudflare.com/pubkey.gpg | sudo gpg --dearmor -o /usr/share/keyrings/cloudflare.gpg echo 'deb [signed-by=/usr/share/keyrings/cloudflare.gpg] https://pkg.cloudflare.com/cloudflared trixie main' | sudo tee /etc/apt/sources.list.d/cloudflared.list Actualizar e Instalar: sudo apt update sudo apt install -y cloudflared 5.3. Creaci\u00f3n y Configuraci\u00f3n del Tunnel La configuraci\u00f3n se realiza en dos partes: autenticaci\u00f3n y definici\u00f3n del t\u00fanel (rutas). A. Autenticaci\u00f3n Autentica tu cloudflared con tu cuenta de Cloudflare. Se te pedir\u00e1 iniciar sesi\u00f3n en el navegador. cloudflared tunnel login Se abrir\u00e1 una URL en tu terminal. P\u00e9gala en tu navegador, inicia sesi\u00f3n en Cloudflare y selecciona tu dominio. B. Crear el T\u00fanel Asigna un nombre a tu t\u00fanel y crea la configuraci\u00f3n local. Crear el T\u00fanel: cloudflared tunnel create wp-tunnel","title":"5. Conexi\u00f3n Segura con Cloudflare Tunnel"},{"location":"seguridad/cloudflare_tunnel/#esto-te-dara-un-id-de-tunel-unico-que-necesitaras","text":"Crear el Archivo de Configuraci\u00f3n (config.yml): Crea el directorio de configuraci\u00f3n para cloudflared y el archivo config.yml. sudo mkdir /etc/cloudflared sudo nano /etc/cloudflared/config.yml Pega la siguiente configuraci\u00f3n, asegur\u00e1ndote de reemplazar con el ID \u00fanico que obtuviste en el paso anterior: tunnel: <TUNNEL-ID> credentials-file: /root/.cloudflared/<TUNNEL-ID>.json ingress: # Regla 1: Tr\u00e1fico del dominio al puerto 80 del servidor local. - hostname: web.tudominio.com # Reemplaza con tu dominio service: http://localhost:80 # Regla final: Bloquea cualquier otra petici\u00f3n no mapeada. - service: http_status:404 Aqu\u00ed, http://localhost:80 se refiere al puerto del host donde est\u00e1 escuchando tu contenedor NGINX. C. Mapeo DNS y T\u00fanel Conecta el t\u00fanel a tu dominio en el panel de Cloudflare. cloudflared tunnel route dns wp-tunnel web.tudominio.com Esto crea autom\u00e1ticamente el registro DNS de tipo CNAME en tu zona de Cloudflare, apuntando a tu t\u00fanel. 5.4. Ejecuci\u00f3n del Tunnel como Servicio Ejecuta el cliente cloudflared como un servicio persistente. Instalar el Servicio del Sistema (Systemd): sudo cloudflared tunnel run --overwrite-service Iniciar y Habilitar el Servicio: sudo systemctl start cloudflared sudo systemctl enable cloudflared Verificar el Estado: sudo systemctl status cloudflared El estado debe mostrarse como active (running). Una vez que el servicio est\u00e9 activo, tu sitio web de WordPress ser\u00e1 accesible a trav\u00e9s de web.tudominio.com sin que hayas abierto un solo puerto en tu router o firewall local. Todo el tr\u00e1fico pasa a trav\u00e9s de la infraestructura segura de Cloudflare.","title":"(Esto te dar\u00e1 un ID de t\u00fanel \u00fanico que necesitar\u00e1s)"},{"location":"web/despliegue_stack_web/","text":"","title":"2.2. Configuraci\u00f3n del stack Nginx-MariaDB-WordPress"},{"location":"web/nginx_conf/","text":"","title":"2.1. Intalaci\u00f3n de Nginx y Hugo"}]}